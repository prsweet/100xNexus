generator client {
	provider = "prisma-client"
	output   = "../generated/prisma"
}

datasource db {
	provider = "postgresql"
}

model users {
	id String @id @default(cuid())
	name String
	email String @unique
	password String
	created_at DateTime @default(now())
	role Role @default(contestee)
	contests contests[]
	mcq_submissions mcq_submissions[]
}

model contests {
	id String @id @default(cuid())
	title String
	description String?
	creator_id String
	start_time DateTime
	end_time DateTime
	created_at DateTime @default(now())
	creator users @relation(fields: [creator_id], references: [id])
	dsa_problems dsa_problems[]
	mcq_questions mcq_questions[]
}

model mcq_questions {
	id String @id @default(cuid())
	contest_id String
	question_text String
	options String[]
	correct_option_index Int
	points Int @default(1)
	created_at DateTime @default(now())
	contest contests @relation(fields: [contest_id], references: [id])
	mcq_submissions mcq_submissions[]
}

model dsa_problems {
	id String @id @default(cuid())
	contest_id String
	title String
	description String?
	tags String[]
	points Int @default(100)
	time_limit Int @default(2000)
	memory_limit Int @default(256)
	created_at DateTime @default(now())
	contest contests @relation(fields: [contest_id], references: [id])
}

model mcq_submissions {
    id String @id @default(cuid())
    user_id String
    user users @relation(fields: [user_id], references: [id])
    question_id String @unique
    question mcq_questions @relation(fields: [question_id], references: [id])
    selected_option_index Int
    is_correct Boolean
    points_earned Int @default(0)
    submitted_at DateTime @default(now())
}

enum Role {
	creator
	contestee
}
